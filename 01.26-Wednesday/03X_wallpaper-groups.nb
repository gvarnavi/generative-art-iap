(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     66344,       1725]
NotebookOptionsPosition[     58176,       1570]
NotebookOutlinePosition[     58657,       1588]
CellTagsIndexPosition[     58614,       1585]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Wallpaper Groups", "Title",
 CellChangeTimes->{
  3.559948400406288*^9, {3.6940927217181253`*^9, 3.694092740906395*^9}, {
   3.787777920516901*^9, 3.787777926080781*^9}, {3.787779610380637*^9, 
   3.78777961561576*^9}, {3.819883196011363*^9, 
   3.819883198356246*^9}},ExpressionUUID->"9a534e0e-ba3e-4528-8349-\
4e37bc8e9664"],

Cell[CellGroupData[{

Cell["Following along", "Section",
 CellChangeTimes->{{3.694093676858917*^9, 3.6940936816804*^9}, {
  3.6940937866096673`*^9, 3.6940937867661943`*^9}, {3.6941317124743834`*^9, 
  3.6941317126488924`*^9}},ExpressionUUID->"7a09c855-31d4-41e8-a12b-\
9787c5b1e78e"],

Cell[BoxData[
 RowBox[{"URLShorten", "[", 
  "\"\<https://raw.githubusercontent.com/gvarnavi/generative-art-iap/master/\
01.26-Wednesday/03X_wallpaper-groups.nb\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.694093199793154*^9, 3.694093228612194*^9}, {
   3.6940932838462496`*^9, 3.6940933356994576`*^9}, {3.726249112392106*^9, 
   3.7262491155801144`*^9}, {3.7262495833255453`*^9, 
   3.7262495839677534`*^9}, {3.7877780577882156`*^9, 3.787778077488515*^9}, {
   3.787779634559353*^9, 3.7877796446717176`*^9}, {3.7879411785182095`*^9, 
   3.787941178748479*^9}, {3.7880019052588615`*^9, 3.788001908819186*^9}, {
   3.7880020590575876`*^9, 3.7880020625770693`*^9}, 3.7880025967005887`*^9, {
   3.819609722888979*^9, 3.819609732242154*^9}, {3.819883202165319*^9, 
   3.819883212524385*^9}, {3.851851673132979*^9, 3.851851673836232*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"a0bfced3-33e3-4888-9a37-b9c698006959"],

Cell["\<\
Evaluate the following command in an empty notebook locally to get this \
notebook\
\>", "Text",
 CellChangeTimes->{{3.694259329708639*^9, 3.6942593739903708`*^9}, {
  3.694259411240712*^9, 3.6942594146914163`*^9}, {3.6942595472624693`*^9, 
  3.6942596457094297`*^9}, {3.694259873235899*^9, 3.6942599655653377`*^9}, {
  3.694260163172273*^9, 3.694260211057214*^9}, {3.69426034623427*^9, 
  3.6942603656403923`*^9}, {3.6942611453919244`*^9, 3.69426116730672*^9}, {
  3.6942614336294503`*^9, 3.694261483631134*^9}, {3.6942615230309973`*^9, 
  3.6942615803275967`*^9}, {3.7093192810050726`*^9, 3.7093192814457455`*^9}, {
  3.7249730861638513`*^9, 3.724973092462925*^9}, {3.7263306086750393`*^9, 
  3.726330610210717*^9}, {3.851536180224536*^9, 3.851536217594239*^9}},
 FontSize->18,ExpressionUUID->"7400d507-f0a1-42cc-8d8b-a7d2307e56c7"],

Cell[BoxData[
 RowBox[{"NotebookOpen", "[", "\"\<https://wolfr.am/11HHWV8RF\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.694093341974367*^9, 3.6940933595080605`*^9}, 
   3.726249127923258*^9, {3.726249586284813*^9, 3.7262495868166833`*^9}, {
   3.787778082380721*^9, 3.7877780831460705`*^9}, 3.787779771623724*^9, 
   3.7880019246001472`*^9, 3.7880020330424585`*^9, 3.788002601600327*^9, 
   3.819609797411695*^9, 3.819883272036664*^9, 
   3.851851684445146*^9},ExpressionUUID->"7cde88ff-2f49-4283-b87b-\
e36d9f05fb7a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Translational Symmetry", "Section",
 CellChangeTimes->{{3.81988384161068*^9, 
  3.8198838454599247`*^9}},ExpressionUUID->"66c45c12-5088-40aa-9738-\
5d7b4a493cf7"],

Cell["\<\
So far we\[CloseCurlyQuote]ve examined strange attractors exhibiting point \
group symmetries.
We can go further by enforcing our maps also preserve translational symmetry \
(and allowing for glide planes)\
\>", "Item",
 CellChangeTimes->{{3.851851814591138*^9, 
  3.851851817358041*^9}},ExpressionUUID->"a8ee1b9f-acf7-4b0f-8b6b-\
7d0582338676"],

Cell[CellGroupData[{

Cell["\<\
We can differentiate two fundamental lattice types: square and hexagonal.\
\>", "Item",
 CellChangeTimes->{{3.851851819196557*^9, 
  3.851851825015717*^9}},ExpressionUUID->"94b8201b-a5e7-4c62-bb79-\
5e6f2932adb0"],

Cell[CellGroupData[{

Cell["\<\
Keen readers will be alarmed we've missed three of the five Bravais lattices \
in 2D - rest assured, we'll recover those using our definition of a \
translation group!\
\>", "Subitem",
 CellChangeTimes->{{3.851851819196557*^9, 
  3.851851824741233*^9}},ExpressionUUID->"e5829303-bf21-4e18-a0c6-\
770f899136e1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"latticeVectors", "[", "\"\<square\>\"", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"latticeVectors", "[", "\"\<hexagonal\>\"", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}], ",", 
       RowBox[{
        SqrtBox["3"], "/", "2"}]}], "}"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7882589779473248`*^9, 3.7882590519304943`*^9}, {
   3.7882594417752204`*^9, 3.788259453987834*^9}, {3.788272508368309*^9, 
   3.788272511884512*^9}, {3.7882751103963323`*^9, 3.7882751140363607`*^9}, {
   3.7882751712578697`*^9, 3.788275173994861*^9}, 
   3.851851759598406*^9},ExpressionUUID->"2f316dae-a6cb-4c1b-a34b-\
1f2721f0dba9"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Let\[CloseCurlyQuote]s quickly add points at each lattice site to see how \
these look like.\
\>", "Item",
 CellChangeTimes->{{3.8518518308166313`*^9, 
  3.851851835928343*^9}},ExpressionUUID->"4eeb7174-bf60-46c7-8859-\
ad81f3645db7"],

Cell[CellGroupData[{

Cell["\<\
First, we can make a square grid at integer combinations of lattice vectors\
\>", "Subitem",
 CellChangeTimes->{{3.8518518308166313`*^9, 
  3.8518518385427227`*^9}},ExpressionUUID->"9d322d56-06c2-4712-90ad-\
be0987462a45"],

Cell[BoxData[
 RowBox[{"Tuples", "[", 
  RowBox[{
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{"-", "3"}], ",", "3"}], "]"}], ",", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.851851797686483*^9, 3.851851805995654*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"14a3d315-5f07-4049-840f-f956bf448800"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Then, we \[OpenCurlyDoubleQuote]stretch\[CloseCurlyDoubleQuote] these using \
our lattice vectors by dotting them on the right\
\>", "Subitem",
 CellChangeTimes->{{3.851851847636106*^9, 
  3.851851894342145*^9}},ExpressionUUID->"6fb920f8-f569-44d0-88e2-\
27796160b596"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tuples", "[", 
   RowBox[{
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{"-", "3"}], ",", "3"}], "]"}], ",", "2"}], "]"}], ".", 
  RowBox[{"latticeVectors", "[", "\"\<hexagonal\>\"", "]"}]}]], "Input",
 CellChangeTimes->{{3.851851879246505*^9, 3.8518519006225767`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"7e423a14-32c8-48e0-aad1-6172a695fa3d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Finally, we add a Point for each lattice site and wrap the expression in \
Graphics\
\>", "Item",
 CellChangeTimes->{{3.851851903545492*^9, 
  3.8518519200221243`*^9}},ExpressionUUID->"19b845f2-7a1c-4781-8ded-\
cfd4c102abe2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Tuples", "[", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{"-", "3"}], ",", "3"}], "]"}], ",", "2"}], "]"}], ".", 
    RowBox[{"latticeVectors", "[", "\"\<hexagonal\>\"", "]"}]}], "//", 
   "Point"}], "//", "Graphics"}]], "Input",
 CellChangeTimes->{{3.851851930590921*^9, 3.851851933456366*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"3fa24ed9-ddbc-49d9-98c8-718590f48783"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Tuples", "[", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{"-", "3"}], ",", "3"}], "]"}], ",", "2"}], "]"}], ".", 
    RowBox[{"latticeVectors", "[", "\"\<square\>\"", "]"}]}], "//", "Point"}],
   "//", "Graphics"}]], "Input",
 CellChangeTimes->{{3.851851940150137*^9, 3.851851941086729*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"975efd5a-ac3f-4d6f-a2bd-b7e14bbcf690"]
}, Open  ]],

Cell[CellGroupData[{

Cell["We\[CloseCurlyQuote]ll also need the dual or inverse lattice to this", \
"Item",
 CellChangeTimes->{{3.851851953183682*^9, 
  3.851851977537917*^9}},ExpressionUUID->"fe1c7b29-2666-4759-b70e-\
fc013bbc399c"],

Cell["This is given by the reciprocal vectors according to ", "Subitem",
 CellChangeTimes->{{3.851851953183682*^9, 
  3.851851987934579*^9}},ExpressionUUID->"ebd9c91f-63dc-485d-822d-\
a9e1edf37bc6"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\t", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"[", 
     RowBox[{
      SubscriptBox["b", "1"], ",", 
      SubscriptBox["b", "2"], ",", 
      SubscriptBox["b", "3"]}], "]"}], "\[Transpose]"], " ", "=", " ", 
   RowBox[{"2", 
    SuperscriptBox[
     RowBox[{"\[Pi]", " ", "[", 
      RowBox[{
       SubscriptBox["a", "1"], ",", 
       SubscriptBox["a", "2"], ",", 
       SubscriptBox["a", "3"]}], "]"}], 
     RowBox[{"-", "1"}]]}]}]}]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.851852027215454*^9, 
  3.851852049919819*^9}},ExpressionUUID->"cefacb11-dd71-4787-8976-\
2c45b5b3193c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"reciprocalVectors", "[", "\"\<square\>\"", "]"}], "=", 
   RowBox[{"2", "\[Pi]", " ", 
    SuperscriptBox[
     RowBox[{"Inverse", "[", 
      RowBox[{"latticeVectors", "[", "\"\<square\>\"", "]"}], "]"}], 
     "\[Transpose]"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"reciprocalVectors", "[", "\"\<hexagonal\>\"", "]"}], "=", 
   RowBox[{"2", "\[Pi]", " ", 
    SuperscriptBox[
     RowBox[{"Inverse", "[", 
      RowBox[{"latticeVectors", "[", "\"\<hexagonal\>\"", "]"}], "]"}], 
     "\[Transpose]"]}]}], ";"}]}], "Input",
 CellChangeTimes->{3.851851943959099*^9},
 CellLabel->"In[14]:=",ExpressionUUID->"a1c09ec3-66ea-4e16-99bd-4ffd060c160b"],

Cell[TextData[{
 "We can ensure a function is translationally invariant,by using the periodic \
sinusoidal functions Sin and Cos as ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["f", "1"], ",", 
    SubscriptBox["f", "2"], ",", 
    SubscriptBox["f", "3"], ",", 
    SubscriptBox["f", "4"]}], TraditionalForm]],ExpressionUUID->
  "9c95aa94-87d6-48b4-841c-43e107d0f893"],
 " according to:"
}], "Item",
 CellChangeTimes->{{3.851852055186329*^9, 
  3.851852057378187*^9}},ExpressionUUID->"c265c61f-f9f6-40cd-ac59-\
d48b0d00f799"],

Cell[BoxData[
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"(", GridBox[{
      {"x"},
      {"y"}
     }], ")"}], "=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{
        SubscriptBox["af", "1"], "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[Sum]", 
           RowBox[{" ", 
            RowBox[{"v", " ", "\[Element]", "V"}]}]], 
          RowBox[{
           SubscriptBox["f", "2"], "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"x", ",", "y"}], ")"}], ".", "v"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x", ",", "y"}], ")"}], ".", "v"}]}], "]"}]},
      {
       RowBox[{
        SubscriptBox["bf", "3"], "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[Sum]", 
           RowBox[{" ", 
            RowBox[{"v", " ", "\[Element]", "V"}]}]], 
          RowBox[{
           SubscriptBox["f", "4"], "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"x", ",", "y"}], ")"}], ".", "v"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x", ",", "y"}], ")"}], ".", "v"}]}], "]"}]}
     }], ")"}]}]}]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.819893905649761*^9, 3.819893964330493*^9}},
 FontSize->18,ExpressionUUID->"195baaf6-4d23-4ec5-95c4-5de710c1bbc2"],

Cell[CellGroupData[{

Cell["where V is any finite subset of lattice vectors", "Subitem",
 CellChangeTimes->{{3.851852067626401*^9, 
  3.851852070690823*^9}},ExpressionUUID->"d20f73d4-60e3-413c-9767-\
00797dba9a46"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"translationGroup", "[", "latticeVectors_", "]"}], "[", 
    RowBox[{"a_", ",", "b_", ",", 
     RowBox[{"{", 
      RowBox[{"f1_", ",", "f2_", ",", "f3_", ",", "f4_"}], "}"}]}], "]"}], 
   "[", 
   RowBox[{"{", 
    RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"a", " ", 
     RowBox[{"f1", "[", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"f2", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], ".", "v"}], "]"}], "+", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], ".", "v"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"v", ",", "latticeVectors"}], "}"}]}], "]"}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"b", " ", 
     RowBox[{"f3", "[", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"f4", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], ".", "v"}], "]"}], "+", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], ".", "v"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"v", ",", "latticeVectors"}], "}"}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "}"}]}]], "Input",
 CellChangeTimes->{{3.788259347823993*^9, 3.788259429464427*^9}, {
   3.788259461045473*^9, 3.7882595461689835`*^9}, {3.7882726242899475`*^9, 
   3.7882726454468727`*^9}, 3.7882730118274407`*^9, {3.7883778015605955`*^9, 
   3.7883778120551653`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"1d3532fb-2387-4c2e-a20d-d0288b897da8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Let\[CloseCurlyQuote]s test this!", "Item",
 CellChangeTimes->{{3.7882751796839495`*^9, 3.788275186043967*^9}, {
  3.851852097199833*^9, 
  3.8518521002795963`*^9}},ExpressionUUID->"565c7ed0-0d75-4ce6-b48b-\
7184deaaea83"],

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"translationGroup", "[", 
     RowBox[{"latticeVectors", "[", "\"\<hexagonal\>\"", "]"}], "]"}], "[", 
    RowBox[{"a", ",", "b", ",", 
     RowBox[{"{", 
      RowBox[{"Sin", ",", "Cos", ",", "Cos", ",", "Sin"}], "}"}]}], "]"}], 
   "[", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.788274798171358*^9, 3.7882748268586655`*^9}, {
  3.7882751947814074`*^9, 3.7882752230149293`*^9}, {3.788283109375602*^9, 
  3.7882831098958125`*^9}, {3.788377814955989*^9, 3.7883778175037313`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"8ef72d0e-6f40-4da7-a1ea-89dabe994556"],

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"translationGroup", "[", 
     RowBox[{"latticeVectors", "[", "\"\<hexagonal\>\"", "]"}], "]"}], "[", 
    RowBox[{"a", ",", "b", ",", 
     RowBox[{"{", 
      RowBox[{"Sin", ",", "Cos", ",", "Cos", ",", "Sin"}], "}"}]}], "]"}], 
   "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], "+", 
    RowBox[{
     RowBox[{"RandomInteger", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "4"}], ",", "4"}], "}"}], ",", "2"}], "]"}], ".", 
     RowBox[{"reciprocalVectors", "[", "\"\<hexagonal\>\"", "]"}]}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7882747737307873`*^9, 3.78827479227234*^9}, {
   3.7882751980249214`*^9, 3.788275237660909*^9}, {3.7882831021740017`*^9, 
   3.788283102690843*^9}, 3.7883778269503593`*^9},
 CellLabel->"In[18]:=",ExpressionUUID->"60e7e60c-c8a4-490d-8955-520f493cc979"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Point Group Symmetries", "Section",
 CellChangeTimes->{{3.79966686105669*^9, 
  3.799666865032632*^9}},ExpressionUUID->"12bb2de2-00ee-4ca0-af0a-\
85b2727de249"],

Cell[CellGroupData[{

Cell[TextData[{
 "In 2D, we only have cyclic ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    SubscriptBox["C", "n"], ")"}], TraditionalForm]],ExpressionUUID->
  "f99b1ffd-857e-4286-a84d-f92896092e63"],
 " and dihedral ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    SubscriptBox["D", "n"], ")"}], TraditionalForm]],ExpressionUUID->
  "b22071f4-3bd1-464e-87ab-9798948a9bff"],
 " symmetries"
}], "Item",
 CellChangeTimes->{{3.851852155986332*^9, 
  3.851852156278576*^9}},ExpressionUUID->"7c757291-a4a2-4019-9523-\
11abc7352db3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"cyclic", "[", "n_", "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"base", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"2", 
             RowBox[{"\[Pi]", "/", "n"}]}], "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", 
              RowBox[{"\[Pi]", "/", "n"}]}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"2", 
             RowBox[{"\[Pi]", "/", "n"}]}], "]"}], ",", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", 
             RowBox[{"\[Pi]", "/", "n"}]}], "]"}]}], "}"}]}], "}"}]}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"AffineTransform", "[", 
        RowBox[{"MatrixPower", "[", 
         RowBox[{"base", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
      RowBox[{"Range", "[", "n", "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"cyclic", "[", "4", "]"}]}], "Input",
 CellChangeTimes->{{3.7883633888519354`*^9, 3.7883633912255836`*^9}, {
  3.788363459717536*^9, 3.7883634830186796`*^9}, {3.788363938793291*^9, 
  3.7883639620529943`*^9}, {3.819894009539966*^9, 3.819894012155264*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"b591ca38-9f5c-460a-a257-e08904005b58"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dihedral", "[", "n_", "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"base", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"2", 
             RowBox[{"\[Pi]", "/", "n"}]}], "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", 
              RowBox[{"\[Pi]", "/", "n"}]}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"2", 
             RowBox[{"\[Pi]", "/", "n"}]}], "]"}], ",", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", 
             RowBox[{"\[Pi]", "/", "n"}]}], "]"}]}], "}"}]}], "}"}]}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Union", "[", 
      RowBox[{
       RowBox[{"cyclic", "[", "n", "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"AffineTransform", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ".", 
           RowBox[{"MatrixPower", "[", 
            RowBox[{"base", ",", "#"}], "]"}]}], "]"}], "&"}], "/@", 
        RowBox[{"Range", "[", "n", "]"}]}]}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"dihedral", "[", "4", "]"}]}], "Input",
 CellChangeTimes->{{3.7883635241524086`*^9, 3.7883635910655737`*^9}, {
  3.7883636681766768`*^9, 3.788363671488887*^9}, {3.7883639654955163`*^9, 
  3.788363970321232*^9}, {3.819894014841825*^9, 3.81989401782728*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"8242a4a1-b41e-456e-bf43-b893eb3fde11"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[OpenCurlyQuote]Extra\[CloseCurlyQuote] Symmetries", "Section",
 CellChangeTimes->{{3.799667846008655*^9, 3.799667859800565*^9}, 
   3.8198940232653933`*^9},ExpressionUUID->"b87a1778-44e8-4718-b32f-\
c884c57cd7a5"],

Cell[CellGroupData[{

Cell["\<\
Plane groups can also exhibit `glide` symmetry,a combination of translation \
and reflection.\
\>", "Item",
 CellChangeTimes->{{3.851852166330557*^9, 
  3.851852169610924*^9}},ExpressionUUID->"2fe6806b-fd27-4737-801e-\
6518c4c9d7d0"],

Cell[CellGroupData[{

Cell["We define these explicitly for the 17 wallpaper groups:", "Subitem",
 CellChangeTimes->{{3.851852166330557*^9, 
  3.8518521692641907`*^9}},ExpressionUUID->"a5281885-7faa-43a6-9f5c-\
9afff7f10d3f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"planeGroupSymmetries", "=", "\[IndentingNewLine]", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<p1\>\"", "\[Rule]", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Lattice\>\"", "\[Rule]", 
         RowBox[{"latticeVectors", "[", "\"\<square\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Group Symmetries\>\"", "\[Rule]", 
         RowBox[{"cyclic", "[", "1", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<Extra Symmetries\>\"", "\[Rule]", 
         RowBox[{"{", "}"}]}]}], "|>"}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<p2\>\"", "\[Rule]", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Lattice\>\"", "\[Rule]", 
         RowBox[{"latticeVectors", "[", "\"\<square\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Group Symmetries\>\"", "\[Rule]", 
         RowBox[{"cyclic", "[", "2", "]"}]}], ",", 
        RowBox[{"\"\<Extra Symmetries\>\"", "\[Rule]", 
         RowBox[{"{", "}"}]}]}], "|>"}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<p1m1\>\"", "\[Rule]", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Lattice\>\"", "\[Rule]", 
         RowBox[{"latticeVectors", "[", "\"\<square\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Group Symmetries\>\"", "\[Rule]", 
         RowBox[{"dihedral", "[", "1", "]"}]}], ",", 
        RowBox[{"\"\<Extra Symmetries\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"ReflectionTransform", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "]"}], "}"}]}]}], "|>"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\"\<p1g1\>\"", "\[Rule]", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Lattice\>\"", "\[Rule]", 
         RowBox[{"latticeVectors", "[", "\"\<square\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Group Symmetries\>\"", "\[Rule]", 
         RowBox[{"dihedral", "[", "1", "]"}]}], ",", 
        RowBox[{"\"\<Extra Symmetries\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"TranslationTransform", "[", 
            RowBox[{"{", 
             RowBox[{"\[Pi]", ",", "0"}], "}"}], "]"}], "@*", 
           RowBox[{"ReflectionTransform", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], "]"}]}], "}"}]}]}], "|>"}]}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\"\<c1m1\>\"", "\[Rule]", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Lattice\>\"", "\[Rule]", 
         RowBox[{"latticeVectors", "[", "\"\<square\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Group Symmetries\>\"", "\[Rule]", 
         RowBox[{"dihedral", "[", "1", "]"}]}], ",", 
        RowBox[{"\"\<Extra Symmetries\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ReflectionTransform", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], "]"}], ",", 
           RowBox[{
            RowBox[{"TranslationTransform", "[", 
             RowBox[{"{", 
              RowBox[{"\[Pi]", ",", "\[Pi]"}], "}"}], "]"}], "@*", 
            RowBox[{"ReflectionTransform", "[", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], "}"}]}]}], "|>"}]}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\"\<p2mm\>\"", "\[Rule]", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Lattice\>\"", "\[Rule]", 
         RowBox[{"latticeVectors", "[", "\"\<square\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Group Symmetries\>\"", "\[Rule]", 
         RowBox[{"dihedral", "[", "2", "]"}]}], ",", 
        RowBox[{"\"\<Extra Symmetries\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ReflectionTransform", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], "]"}], ",", 
           RowBox[{"ReflectionTransform", "[", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}], "]"}]}], "}"}]}]}], "|>"}]}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\"\<p2gg\>\"", "\[Rule]", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Lattice\>\"", "\[Rule]", 
         RowBox[{"latticeVectors", "[", "\"\<square\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Group Symmetries\>\"", "\[Rule]", 
         RowBox[{"dihedral", "[", "2", "]"}]}], ",", 
        RowBox[{"\"\<Extra Symmetries\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"TranslationTransform", "[", 
             RowBox[{"{", 
              RowBox[{"\[Pi]", ",", "\[Pi]"}], "}"}], "]"}], "@*", 
            RowBox[{"ReflectionTransform", "[", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"TranslationTransform", "[", 
             RowBox[{"{", 
              RowBox[{"\[Pi]", ",", "\[Pi]"}], "}"}], "]"}], "@*", 
            RowBox[{"ReflectionTransform", "[", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}], "]"}]}]}], "}"}]}]}], "|>"}]}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\"\<p2mg\>\"", "\[Rule]", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Lattice\>\"", "\[Rule]", 
         RowBox[{"latticeVectors", "[", "\"\<square\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Group Symmetries\>\"", "\[Rule]", 
         RowBox[{"dihedral", "[", "2", "]"}]}], ",", 
        RowBox[{"\"\<Extra Symmetries\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"TranslationTransform", "[", 
             RowBox[{"{", 
              RowBox[{"\[Pi]", ",", "0"}], "}"}], "]"}], "@*", 
            RowBox[{"ReflectionTransform", "[", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], "]"}]}], ",", 
           RowBox[{"ReflectionTransform", "[", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}], "]"}]}], "}"}]}]}], "|>"}]}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\"\<c2mm\>\"", "\[Rule]", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<Lattice\>\"", "\[Rule]", 
          RowBox[{"latticeVectors", "[", "\"\<square\>\"", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<Group Symmetries\>\"", "\[Rule]", 
          RowBox[{"dihedral", "[", "2", "]"}]}], ",", 
         RowBox[{"\"\<Extra Symmetries\>\"", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ReflectionTransform", "[", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}], "]"}], ",", 
            RowBox[{"ReflectionTransform", "[", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], "]"}], ",", 
            RowBox[{
             RowBox[{"TranslationTransform", "[", 
              RowBox[{"{", 
               RowBox[{"\[Pi]", ",", "\[Pi]"}], "}"}], "]"}], "@*", 
             RowBox[{"ReflectionTransform", "[", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"TranslationTransform", "[", 
              RowBox[{"{", 
               RowBox[{"\[Pi]", ",", "\[Pi]"}], "}"}], "]"}], "@*", 
             RowBox[{"ReflectionTransform", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0"}], "}"}], "]"}]}]}], "}"}]}]}], "|>"}], 
       "|>"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\"\<p4\>\"", "\[Rule]", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Lattice\>\"", "\[Rule]", 
         RowBox[{"latticeVectors", "[", "\"\<square\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Group Symmetries\>\"", "\[Rule]", 
         RowBox[{"cyclic", "[", "4", "]"}]}], ",", 
        RowBox[{"\"\<Extra Symmetries\>\"", "\[Rule]", 
         RowBox[{"{", "}"}]}]}], "|>"}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<p4mm\>\"", "\[Rule]", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Lattice\>\"", "\[Rule]", 
         RowBox[{"latticeVectors", "[", "\"\<square\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Group Symmetries\>\"", "\[Rule]", 
         RowBox[{"dihedral", "[", "4", "]"}]}], ",", 
        RowBox[{"\"\<Extra Symmetries\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"ReflectionTransform", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "]"}], "}"}]}]}], "|>"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\"\<p4gm\>\"", "\[Rule]", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Lattice\>\"", "\[Rule]", 
         RowBox[{"latticeVectors", "[", "\"\<square\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Group Symmetries\>\"", "\[Rule]", 
         RowBox[{"dihedral", "[", "4", "]"}]}], ",", 
        RowBox[{"\"\<Extra Symmetries\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"TranslationTransform", "[", 
            RowBox[{"{", 
             RowBox[{"\[Pi]", ",", "0"}], "}"}], "]"}], "@*", 
           RowBox[{"ReflectionTransform", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], "]"}]}], "}"}]}]}], "|>"}]}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\"\<p3\>\"", "\[Rule]", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Lattice\>\"", "\[Rule]", 
         RowBox[{"latticeVectors", "[", "\"\<hexagonal\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Group Symmetries\>\"", "\[Rule]", 
         RowBox[{"cyclic", "[", "3", "]"}]}], ",", 
        RowBox[{"\"\<Extra Symmetries\>\"", "\[Rule]", 
         RowBox[{"{", "}"}]}]}], "|>"}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<p3m1\>\"", "\[Rule]", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Lattice\>\"", "\[Rule]", 
         RowBox[{"latticeVectors", "[", "\"\<hexagonal\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Group Symmetries\>\"", "\[Rule]", 
         RowBox[{"dihedral", "[", "3", "]"}]}], ",", 
        RowBox[{"\"\<Extra Symmetries\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"ReflectionTransform", "[", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], "]"}], "}"}]}]}], "|>"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\"\<p31m\>\"", "\[Rule]", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Lattice\>\"", "\[Rule]", 
         RowBox[{"latticeVectors", "[", "\"\<hexagonal\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Group Symmetries\>\"", "\[Rule]", 
         RowBox[{"dihedral", "[", "3", "]"}]}], ",", 
        RowBox[{"\"\<Extra Symmetries\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"ReflectionTransform", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "]"}], "}"}]}]}], "|>"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\"\<p6\>\"", "->", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Lattice\>\"", "\[Rule]", 
         RowBox[{"latticeVectors", "[", "\"\<hexagonal\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Group Symmetries\>\"", "\[Rule]", 
         RowBox[{"cyclic", "[", "6", "]"}]}], ",", 
        RowBox[{"\"\<Extra Symmetries\>\"", "\[Rule]", 
         RowBox[{"{", "}"}]}]}], "|>"}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<p6m\>\"", "->", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Lattice\>\"", "\[Rule]", 
         RowBox[{"latticeVectors", "[", "\"\<hexagonal\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Group Symmetries\>\"", "\[Rule]", 
         RowBox[{"dihedral", "[", "6", "]"}]}], ",", 
        RowBox[{"\"\<Extra Symmetries\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"ReflectionTransform", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "]"}], "}"}]}]}], "|>"}]}]}], 
    "\[IndentingNewLine]", "|>"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.788275295017336*^9, 3.7882754403346863`*^9}, {
   3.7882755099036455`*^9, 3.7882755169669104`*^9}, {3.7882757682041197`*^9, 
   3.7882757804879155`*^9}, {3.788275811589693*^9, 3.788275824408794*^9}, {
   3.7882758869026036`*^9, 3.7882760043414564`*^9}, {3.7882760789416747`*^9, 
   3.788276096107462*^9}, {3.788276132059368*^9, 3.7882762225064955`*^9}, {
   3.7882762562708445`*^9, 3.788276361405883*^9}, {3.788304919855076*^9, 
   3.788305103653309*^9}, {3.788353967312126*^9, 3.7883539705360746`*^9}, {
   3.7883540325866923`*^9, 3.788354032667055*^9}, 3.7883541515953255`*^9, {
   3.7883542065212693`*^9, 3.7883542496001787`*^9}, {3.7883543239521837`*^9, 
   3.7883543477705803`*^9}, {3.788355818765106*^9, 3.7883558270415564`*^9}, {
   3.7883558572411003`*^9, 3.7883559026604223`*^9}, {3.788357009841091*^9, 
   3.7883570423510904`*^9}, 3.788357079145959*^9, {3.7883571148465824`*^9, 
   3.788357322994234*^9}, {3.788357366883814*^9, 3.788357463098894*^9}, {
   3.7883575559837885`*^9, 3.7883576020009007`*^9}, {3.7883576358818336`*^9, 
   3.7883579887332993`*^9}, {3.7883629374018745`*^9, 
   3.7883629765241804`*^9}, {3.7883632919142294`*^9, 
   3.7883632930018435`*^9}, {3.788363355120734*^9, 3.7883633561906796`*^9}, {
   3.78836370868761*^9, 3.788363782405195*^9}, {3.788363858718699*^9, 
   3.788363864946126*^9}, {3.7883639815975847`*^9, 3.7883639830005026`*^9}, {
   3.788364044085985*^9, 3.7883641036754475`*^9}, {3.7883771750469627`*^9, 
   3.7883772018746634`*^9}, {3.788377279688024*^9, 3.7883773239197607`*^9}, {
   3.7883773578398275`*^9, 3.788377626770327*^9}, {3.819886435554104*^9, 
   3.819886458721525*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"7a8c3372-0e28-4701-90d1-919ecca3e893"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
For example, for wallpaper group p4gm, we consider the additional glide plane:\
\>", "Item",
 CellChangeTimes->{{3.8518521768757267`*^9, 
  3.8518521771689663`*^9}},ExpressionUUID->"0e914c5b-e89f-4932-885d-\
98f1fc4d86a5"],

Cell[BoxData[
 RowBox[{"planeGroupSymmetries", "[", "\"\<p4gm\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.819894068206339*^9, 3.8198940747478933`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"34cb7696-72d7-40d5-adb4-134df9af6e41"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Function Equivariance", "Section",
 CellChangeTimes->{{3.8198940816043577`*^9, 
  3.819894085956378*^9}},ExpressionUUID->"12c2c3d9-dc8f-4a7f-b8ad-\
3379d8af03e5"],

Cell["\<\
We\[CloseCurlyQuote]re looking to generate strange attractor functions which, \
when nested, produce the desired plane-group symmetry. \
\>", "Item",
 CellChangeTimes->{{3.8518521847887697`*^9, 
  3.8518521880621557`*^9}},ExpressionUUID->"121c1215-e818-40b1-bbf7-\
e6c04a8217b7"],

Cell[CellGroupData[{

Cell["\<\
We therefore need to define what it means for a function to have a particular \
symmetry.\
\>", "Item",
 CellChangeTimes->{{3.8518521847887697`*^9, 3.8518521947204533`*^9}, {
  3.851852249605012*^9, 
  3.851852249607016*^9}},ExpressionUUID->"1595b219-35fe-4495-b9c6-\
5c01d4d9d28a"],

Cell["\<\
We\[CloseCurlyQuote]ll define a function f to be equivariant with respect to \
symmetry \[Sigma] if f(\[Sigma](x)) = \[Sigma](f(x)), i.e. if the function \
and the symmetry operation commute.\
\>", "Subitem",
 CellChangeTimes->{{3.8518521847887697`*^9, 3.8518521947204533`*^9}, {
  3.8518522505605183`*^9, 
  3.851852292121706*^9}},ExpressionUUID->"8d8ea756-d014-437d-b91e-\
7eb5740d1d07"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Putting this all-together, we arrive at our wallpaperGroup function, which \
takes the amplitudes, a, b, periodic functions ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["f", "1"], ",", 
    SubscriptBox["f", "2"], ",", 
    SubscriptBox["f", "3"], ",", 
    SubscriptBox["f", "4"]}], TraditionalForm]],ExpressionUUID->
  "3eecc5b5-dac2-4f28-a060-f2bba4fcfa47"],
 " and the wallpaper group "
}], "Item",
 CellChangeTimes->{{3.851852301198586*^9, 
  3.851852306084412*^9}},ExpressionUUID->"3fb2f1f9-c0f2-4815-a25f-\
a578fe9fdb40"],

Cell[CellGroupData[{

Cell["and returns a functional form exhibiting that symmetry:", "Subitem",
 CellChangeTimes->{{3.851852301198586*^9, 
  3.851852305833856*^9}},ExpressionUUID->"900f7167-f439-4d10-a031-\
fc13bec10c6b"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "wallpaperGroup", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"wallpaperGroup", "[", "wallpaper_", "]"}], "[", 
     RowBox[{"a_", ",", "b_", ",", 
      RowBox[{"{", 
       RowBox[{"f1_", ",", "f2_", ",", "f3_", ",", "f4_"}], "}"}]}], "]"}], 
    "[", "r_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"wallpaperGroup", "[", "wallpaper", "]"}], "[", 
      RowBox[{"a", ",", "b", ",", 
       RowBox[{"{", 
        RowBox[{"f1", ",", "f2", ",", "f3", ",", "f4"}], "}"}]}], "]"}], "[", 
     "r", "]"}], "=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"latticeVectors", "=", 
         RowBox[{"planeGroupSymmetries", "[", 
          RowBox[{"wallpaper", ",", "\"\<Lattice\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"groupSymmetries", "=", 
         RowBox[{"planeGroupSymmetries", "[", 
          RowBox[{"wallpaper", ",", "\"\<Group Symmetries\>\""}], "]"}]}], 
        ",", 
        RowBox[{"extraSymmetries", "=", 
         RowBox[{"planeGroupSymmetries", "[", 
          RowBox[{"wallpaper", ",", "\"\<Extra Symmetries\>\""}], "]"}]}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"translationGroup", "[", "latticeVectors", "]"}], "[", 
             RowBox[{"a", ",", "b", ",", 
              RowBox[{"{", 
               RowBox[{"f1", ",", "f2", ",", "f3", ",", "f4"}], "}"}]}], 
             "]"}], "[", 
            RowBox[{"g", "[", "r", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"g", ",", "groupSymmetries"}], "}"}]}], "]"}], "/", 
         RowBox[{"Length", "[", "groupSymmetries", "]"}]}], "+", 
        "\[IndentingNewLine]", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"translationGroup", "[", "latticeVectors", "]"}], "[", 
             RowBox[{"a", ",", "b", ",", 
              RowBox[{"{", 
               RowBox[{"f1", ",", "f2", ",", "f3", ",", "f4"}], "}"}]}], 
             "]"}], "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Sigma]", "@*", "g"}], ")"}], "[", "r", "]"}], "]"}], 
           "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Length", "[", "extraSymmetries", "]"}], 
             RowBox[{"Length", "[", "groupSymmetries", "]"}]}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"g", ",", "groupSymmetries"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Sigma]", ",", "extraSymmetries"}], "}"}]}], "]"}]}], 
       "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"wallpaperGroup", "[", "\"\<p4gm\>\"", "]"}], "[", 
   RowBox[{"a", ",", "b", ",", 
    RowBox[{"{", 
     RowBox[{"Sin", ",", "Cos", ",", "Cos", ",", "Sin"}], "}"}]}], "]"}], "[", 
  RowBox[{"{", 
   RowBox[{"x", ",", "y"}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.788259620001566*^9, 3.788259737807403*^9}, {
   3.788274324361888*^9, 3.788274362485777*^9}, {3.78827463187131*^9, 
   3.7882746332013645`*^9}, {3.7882764028180995`*^9, 
   3.7882764061323853`*^9}, {3.7882765052040596`*^9, 3.788276523522112*^9}, {
   3.7882765671104965`*^9, 3.788276678415027*^9}, {3.788279096390973*^9, 
   3.7882791507992887`*^9}, 3.788279203042323*^9, {3.7882955754625745`*^9, 
   3.7882956004326267`*^9}, {3.7882956641316304`*^9, 3.78829568847462*^9}, {
   3.788295823243425*^9, 3.788295837838972*^9}, {3.788296351507305*^9, 
   3.7882963637292695`*^9}, {3.7882963984296246`*^9, 3.788296407917157*^9}, {
   3.7882967443787966`*^9, 3.788296761486051*^9}, {3.7883776883703012`*^9, 
   3.7883777447200203`*^9}, {3.7883777837302294`*^9, 
   3.7883777847701483`*^9}, {3.788377834710091*^9, 3.7883778750305967`*^9}, {
   3.8198941386219387`*^9, 3.8198941391226273`*^9}, 3.851852511027626*^9},
 CellLabel->"In[34]:=",ExpressionUUID->"19de2907-9c6e-443a-90e1-e4f98e6ad428"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Visualization Scheme ", "Section",
 CellChangeTimes->{{3.799667952257666*^9, 3.799667962673786*^9}, {
  3.819894143396541*^9, 
  3.8198941459005737`*^9}},ExpressionUUID->"dc08f56e-8d6f-4e97-bdd4-\
2c27ecb891e2"],

Cell[CellGroupData[{

Cell["\<\
Now that we have our general symmetry-preserving chaotic attractors,we can \
follow a similar scheme as in the strange attractor notebook to visualize \
these.\
\>", "Item",
 CellChangeTimes->{{3.851852324630721*^9, 
  3.85185232815617*^9}},ExpressionUUID->"dbf3dcda-a7ea-42bc-8196-\
52c732ec380c"],

Cell["\<\
To extenuate the fractal nature of these maps,we take this opportunity to \
demonstrate another visualization scheme called `Orbit Traps`.\
\>", "Subitem",
 CellChangeTimes->{{3.851852324630721*^9, 
  3.851852327905693*^9}},ExpressionUUID->"5eb9a1fe-867d-4af7-af71-\
9fe8ad0a18d9"]
}, Open  ]],

Cell[TextData[{
 "According to Wikipedia:\n",
 StyleBox["An orbit trap is a method of colouring fractal images based upon \
how close an iterative function,used to create the fractal,approaches a \
geometric shape,called a \[OpenCurlyDoubleQuote]trap\[CloseCurlyDoubleQuote].",
  FontSlant->"Italic"]
}], "Item",
 CellChangeTimes->{{3.8518523354774837`*^9, 
  3.851852335747521*^9}},ExpressionUUID->"28bc21fa-2e72-480a-bee5-\
d3c67ff90996"],

Cell[CellGroupData[{

Cell["We will use point traps.", "Item",
 CellChangeTimes->{{3.851852342061281*^9, 
  3.85185234569273*^9}},ExpressionUUID->"e846384c-0d29-4bf5-9418-\
2aa70da72fb7"],

Cell[CellGroupData[{

Cell["\<\
In order to preserve a wallpaper groups' periodic nature,we will use periodic \
point traps as-well.\
\>", "Subitem",
 CellChangeTimes->{{3.851852342061281*^9, 
  3.851852342731051*^9}},ExpressionUUID->"db243018-f8f7-4a77-9205-\
47bdb8f8b1d7"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "orbitTraps", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"orbitTraps", "[", "radius_", "]"}], ":=", 
  RowBox[{"<|", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"1", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0.", ",", "0."}], "}"}], "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"2", "\[Rule]", 
     RowBox[{"CirclePoints", "[", 
      RowBox[{
       RowBox[{
        FractionBox["2", 
         SqrtBox["3"]], "radius"}], ",", "3"}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"3", "->", 
     RowBox[{"CirclePoints", "[", 
      RowBox[{
       RowBox[{
        SqrtBox["2"], "radius"}], ",", "4"}], "]"}]}], ",", 
    RowBox[{"4", "->", 
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{"CirclePoints", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"2", "radius"}], ",", 
           RowBox[{"\[Pi]", "/", "6"}]}], "}"}], ",", "6"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.", ",", "0."}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "|>"}]}]}], "Input",
 CellChangeTimes->{{3.7883783833309937`*^9, 3.7883783855512156`*^9}, {
   3.7883787085712776`*^9, 3.7883787259743433`*^9}, {3.7883787681780915`*^9, 
   3.7883787736219406`*^9}, {3.788378853371561*^9, 3.7883788651268735`*^9}, {
   3.7883789105766373`*^9, 3.7883789178920045`*^9}, {3.788379040536703*^9, 
   3.788379150706951*^9}, 3.788379224752178*^9, 3.7883793110414195`*^9, 
   3.788379349872411*^9, 3.7883859106836195`*^9, {3.8198937202646217`*^9, 
   3.81989372573612*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"f599cf75-6528-404f-ab93-b3a27b6ba2ce"],

Cell[BoxData[
 RowBox[{"Multicolumn", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Circle", "[", "#", "]"}], "&"}], "/@", 
        RowBox[{
         RowBox[{"orbitTraps", "[", "1", "]"}], "[", "i", "]"}]}], ",", 
       RowBox[{"Axes", "\[Rule]", "True"}], ",", 
       RowBox[{"Ticks", "\[Rule]", "None"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "4"}], "}"}]}], "]"}], ",", "2", ",", 
   RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.788379054932243*^9, 3.788379057616824*^9}, {
  3.788379106611923*^9, 3.788379107831875*^9}, {3.7883791521521406`*^9, 
  3.7883791947923117`*^9}, {3.7883792272824507`*^9, 3.7883792322624226`*^9}, {
  3.7883793601021976`*^9, 3.788379407092521*^9}, {3.788379874977849*^9, 
  3.788379919641301*^9}, {3.819886502914342*^9, 3.81988650657646*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"7e176713-c3cc-4c3a-ae44-42880167e7f3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Essentially,we\[CloseCurlyQuote]ll keep iterating our wallpaper strange \
attractor-until our function \[OpenCurlyQuote]falls\[CloseCurlyQuote] in one \
of our traps\
\>", "Item",
 CellChangeTimes->{{3.851852357166771*^9, 
  3.851852364410139*^9}},ExpressionUUID->"2526f453-ed28-4c88-9951-\
b13e58c10fcb"],

Cell["\<\
and then return the normalized distance of that point to the center of the \
trap\
\>", "Subitem",
 CellChangeTimes->{{3.851852357166771*^9, 
  3.851852359291161*^9}},ExpressionUUID->"7b7619e4-6e1c-4775-b628-\
4899cf81a809"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compiled Strange Attractors", "Section",
 CellChangeTimes->{{3.819894257654208*^9, 
  3.819894263540797*^9}},ExpressionUUID->"2c8d1b75-ae02-49e5-a2fa-\
c53e51e9eb74"],

Cell[CellGroupData[{

Cell["\<\
Like before,we\[CloseCurlyQuote]ll compile our iteration code in C to get a \
reasonable speed-up!\
\>", "Item",
 CellChangeTimes->{{3.851852371357502*^9, 
  3.8518523800875874`*^9}},ExpressionUUID->"59f87162-69d0-4c34-99ff-\
8aab7b7c8c80"],

Cell[CellGroupData[{

Cell["\<\
We define our main logic as a function,which takes our lattice function,and \
our particular orbit trap:\
\>", "Subitem",
 CellChangeTimes->{{3.851852371357502*^9, 
  3.8518523804993057`*^9}},ExpressionUUID->"567fb4ab-e991-48a8-a9d2-\
9eaecab82ca7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"compilerFunction", "[", 
   RowBox[{"latticeFunc_", ",", "costFunc_"}], "]"}], ":=", 
  RowBox[{"Compile", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xmin", ",", "_Real"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"xmax", ",", "_Real"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"ymin", ",", "_Real"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ymax", ",", "_Real"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"delta", ",", "_Real"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"itmax", ",", "_Integer"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"escapeRadius", ",", "_Real"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"a", ",", "_Real"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"b", ",", "_Real"}], "}"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"iters", ",", "x", ",", "y", ",", "cost"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"iters", "=", "0"}], ";", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], "=", 
          RowBox[{"{", 
           RowBox[{"rx", ",", "ry"}], "}"}]}], ";", 
         RowBox[{"cost", "=", "1.0"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"iters", "<", "itmax"}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{"cost", "\[GreaterEqual]", "1"}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"iters", "++"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", "y"}], "}"}], "=", "latticeFunc"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"cost", "=", "costFunc"}], ";"}]}], "\[IndentingNewLine]",
           "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "cost"}],
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"rx", ",", "xmin", ",", "xmax", ",", "delta"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"ry", ",", "ymin", ",", "ymax", ",", "delta"}], "}"}]}], 
       "]"}]}], "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
    RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
    RowBox[{"CompilationOptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<ExpressionOptimization\>\"", "\[Rule]", "False"}], 
      "}"}]}]}], "]"}]}]], "Input",
 CellLabel->"In[31]:=",ExpressionUUID->"0bc3ee66-d90a-4baf-92ba-6b29ff393f2f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Pre-compute all ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["f", "1"], ",", 
    SubscriptBox["f", "2"], ",", 
    SubscriptBox["f", "3"], ",", 
    SubscriptBox["f", "4"]}], TraditionalForm]],ExpressionUUID->
  "6f61883c-d9da-4930-b4d1-652707e2a739"],
 " function permutations for each wallpaper group:"
}], "Item",
 CellChangeTimes->{{3.851852548639773*^9, 
  3.851852548886323*^9}},ExpressionUUID->"d33a68f2-4588-4751-b72a-\
6a9deefa89a3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sinusoids", "=", 
   RowBox[{"Tuples", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Sin", ",", "Cos"}], "}"}], ",", "4"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dataset", "[", 
   RowBox[{"precomputedLatticeFunctions", "=", 
    RowBox[{"Association", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"i", "\[Rule]", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"Association", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"j", "->", 
              RowBox[{
               RowBox[{
                RowBox[{"wallpaperGroup", "[", "i", "]"}], "[", 
                RowBox[{"a", ",", "b", ",", 
                 RowBox[{"sinusoids", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "[", 
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "16"}], "}"}]}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"0", ",", "_"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"_", ",", "0"}], "}"}]}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Keys", "[", "planeGroupSymmetries", "]"}]}], "}"}]}], "]"}],
      "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.819869915833673*^9, 3.819869916544166*^9}, 
   3.819886559505019*^9, {3.819886589568201*^9, 3.81988660194562*^9}, {
   3.819886864468096*^9, 3.819886865300839*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"bec39be6-39b6-41ff-ae65-1b6726c1e096"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Pre-compute all orbit trap functions:", "Item",
 CellChangeTimes->{{3.8518525550952463`*^9, 
  3.851852555388337*^9}},ExpressionUUID->"90c25161-e66c-47ff-b5e0-\
4087f6ffc576"],

Cell[BoxData[
 RowBox[{
  RowBox[{"precomputedCostFunctions", "=", 
   RowBox[{"Association", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"i", "->", 
       RowBox[{
        RowBox[{"Min", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Norm", "[", 
            RowBox[{
             RowBox[{"pt", " ", "escapeRadius"}], "-", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"pt", ",", " ", 
             RowBox[{
              RowBox[{"orbitTraps", "[", "1", "]"}], "[", "i", "]"}]}], 
            "}"}]}], "]"}], "]"}], "/", "escapeRadius"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "4"}], "}"}]}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.81988687319697*^9, 3.819886955861569*^9}, 
   3.819893739823008*^9},
 CellLabel->"In[40]:=",ExpressionUUID->"a77277d4-0863-4052-bc54-c9d1abab5ec1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "And finally,write a wrapper function to compile the iterator for a \
particular wallpaper group using a RandomChoice of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["f", "1"], ",", 
    SubscriptBox["f", "2"], ",", 
    SubscriptBox["f", "3"], ",", 
    SubscriptBox["f", "4"]}], TraditionalForm]],ExpressionUUID->
  "0525d705-8b2a-45c0-b577-a2ba75c03c54"]
}], "Item",
 CellChangeTimes->{{3.851852565751403*^9, 
  3.851852565967525*^9}},ExpressionUUID->"53c62145-e0da-4a13-bd64-\
da17b67c6866"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"compilerWrapper", "[", 
    RowBox[{"planeGroup_", ",", "orbitTrap_"}], "]"}], ":=", 
   RowBox[{"compilerFunction", "[", 
    RowBox[{
     RowBox[{"RandomChoice", "[", 
      RowBox[{"precomputedLatticeFunctions", "[", "planeGroup", "]"}], "]"}], 
     ",", 
     RowBox[{"precomputedCostFunctions", "[", "orbitTrap", "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cf", "[", "\"\<p2mg\>\"", "]"}], "=", 
  RowBox[{"compilerWrapper", "[", 
   RowBox[{"\"\<p2mg\>\"", ",", "1"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8198869912679567`*^9, 3.819887054677919*^9}, {
  3.819894369991682*^9, 3.819894370326181*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"dd882544-5c6b-4bb7-b9cd-d83014716a68"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Visualization Function", "Section",
 CellChangeTimes->{{3.8198943775188723`*^9, 
  3.819894382719836*^9}},ExpressionUUID->"00d26a81-25aa-4120-9f76-\
d790e36d0b7f"],

Cell[CellGroupData[{

Cell["\<\
Finally, we write a visualization function, using some built-in color schemes:\
\>", "Item",
 CellChangeTimes->{{3.851852579127015*^9, 
  3.851852579404532*^9}},ExpressionUUID->"e91bdce8-abf2-419d-aa3b-\
973224567f34"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "visualizeWallpaper", "]"}], "\n", 
 RowBox[{
  RowBox[{"visualizeWallpaper", "[", 
   RowBox[{"wallpaperGroup_", ",", "orbitTrap_", ",", "colFunction_"}], "]"}],
   ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"iterator", "=", 
       RowBox[{"compilerWrapper", "[", 
        RowBox[{"wallpaperGroup", ",", "orbitTrap"}], "]"}]}], ",", 
      RowBox[{"range", "=", 
       RowBox[{"N", "[", 
        RowBox[{"4", " ", "Pi"}], "]"}]}]}], "}"}], ",", 
    RowBox[{"ArrayPlot", "[", 
     RowBox[{
      RowBox[{"Log", "[", 
       RowBox[{
        RowBox[{"iterator", "[", 
         RowBox[{
          RowBox[{"-", "range"}], ",", "range", ",", 
          RowBox[{"-", "range"}], ",", "range", ",", ".1", ",", "100", ",", 
          "2.5", ",", 
          RowBox[{"RandomReal", "[", 
           RowBox[{"{", 
            RowBox[{"0.", ",", "3."}], "}"}], "]"}], ",", 
          RowBox[{"RandomReal", "[", 
           RowBox[{"{", 
            RowBox[{"0.", ",", "3."}], "}"}], "]"}]}], "]"}], "+", "1"}], 
       "]"}], ",", 
      RowBox[{"ColorFunction", "\[Rule]", "colFunction"}], ",", 
      RowBox[{"ImagePadding", "\[Rule]", "None"}], ",", 
      RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "200"}], ",", 
      RowBox[{"Frame", "\[Rule]", "False"}], ",", 
      RowBox[{"PlotLabel", "\[Rule]", 
       RowBox[{"Style", "[", 
        RowBox[{"wallpaperGroup", ",", "16", ",", "Black"}], "]"}]}]}], 
     "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.819894432376013*^9, 3.8198944323927193`*^9}, {
  3.819894765325094*^9, 3.8198947655005074`*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"669003af-a887-4164-9f45-da99d322e872"],

Cell[BoxData[
 RowBox[{"visualizeWallpaper", "[", 
  RowBox[{"\"\<p3m1\>\"", ",", "2", ",", "\"\<GrayYellowTones\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.819894436983346*^9, 3.81989443699964*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"159a0139-36d1-4980-a7ff-406b006b36ae"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440, 786},
WindowMargins->{{1440, Automatic}, {0, Automatic}},
PrivateNotebookOptions->{"CloudPublishPath"->"/Published/03X_wallpaper-groups.\
nb"},
FrontEndVersion->"13.0 for Linux x86 (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"439e9e7f-72a6-4227-9bb7-e75e260f041c"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 332, 6, 98, "Title",ExpressionUUID->"9a534e0e-ba3e-4528-8349-4e37bc8e9664"],
Cell[CellGroupData[{
Cell[937, 32, 261, 4, 68, "Section",ExpressionUUID->"7a09c855-31d4-41e8-a12b-9787c5b1e78e"],
Cell[1201, 38, 911, 13, 29, "Input",ExpressionUUID->"a0bfced3-33e3-4888-9a37-b9c698006959"],
Cell[2115, 53, 844, 13, 39, "Text",ExpressionUUID->"7400d507-f0a1-42cc-8d8b-a7d2307e56c7"],
Cell[2962, 68, 522, 9, 29, "Input",ExpressionUUID->"7cde88ff-2f49-4283-b87b-e36d9f05fb7a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3521, 82, 168, 3, 68, "Section",ExpressionUUID->"66c45c12-5088-40aa-9738-5d7b4a493cf7"],
Cell[3692, 87, 355, 8, 53, "Item",ExpressionUUID->"a8ee1b9f-acf7-4b0f-8b6b-7d0582338676"],
Cell[CellGroupData[{
Cell[4072, 99, 223, 5, 32, "Item",ExpressionUUID->"94b8201b-a5e7-4c62-bb79-5e6f2932adb0"],
Cell[CellGroupData[{
Cell[4320, 108, 320, 7, 26, "Subitem",ExpressionUUID->"e5829303-bf21-4e18-a0c6-770f899136e1"],
Cell[4643, 117, 1015, 28, 53, "Input",ExpressionUUID->"2f316dae-a6cb-4c1b-a34b-1f2721f0dba9"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[5707, 151, 244, 6, 32, "Item",ExpressionUUID->"4eeb7174-bf60-46c7-8859-ad81f3645db7"],
Cell[CellGroupData[{
Cell[5976, 161, 232, 5, 26, "Subitem",ExpressionUUID->"9d322d56-06c2-4712-90ad-be0987462a45"],
Cell[6211, 168, 305, 7, 29, "Input",ExpressionUUID->"14a3d315-5f07-4049-840f-f956bf448800"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6553, 180, 279, 6, 26, "Subitem",ExpressionUUID->"6fb920f8-f569-44d0-88e2-27796160b596"],
Cell[6835, 188, 392, 9, 29, "Input",ExpressionUUID->"7e423a14-32c8-48e0-aad1-6172a695fa3d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[7276, 203, 235, 6, 32, "Item",ExpressionUUID->"19b845f2-7a1c-4781-8ded-cfd4c102abe2"],
Cell[7514, 211, 466, 12, 29, "Input",ExpressionUUID->"3fa24ed9-ddbc-49d9-98c8-718590f48783"],
Cell[7983, 225, 462, 12, 29, "Input",ExpressionUUID->"975efd5a-ac3f-4d6f-a2bd-b7e14bbcf690"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8482, 242, 212, 4, 32, "Item",ExpressionUUID->"fe1c7b29-2666-4759-b70e-fc013bbc399c"],
Cell[8697, 248, 198, 3, 26, "Subitem",ExpressionUUID->"ebd9c91f-63dc-485d-822d-a9e1edf37bc6"]
}, Open  ]],
Cell[8910, 254, 620, 19, 25, "DisplayFormulaNumbered",ExpressionUUID->"cefacb11-dd71-4787-8976-2c45b5b3193c"],
Cell[9533, 275, 722, 18, 51, "Input",ExpressionUUID->"a1c09ec3-66ea-4e16-99bd-4ffd060c160b"],
Cell[10258, 295, 538, 15, 32, "Item",ExpressionUUID->"c265c61f-f9f6-40cd-ac59-d48b0d00f799"],
Cell[10799, 312, 1315, 42, 53, "DisplayFormulaNumbered",ExpressionUUID->"195baaf6-4d23-4ec5-95c4-5de710c1bbc2"],
Cell[CellGroupData[{
Cell[12139, 358, 192, 3, 26, "Subitem",ExpressionUUID->"d20f73d4-60e3-413c-9767-00797dba9a46"],
Cell[12334, 363, 1706, 47, 113, "Input",ExpressionUUID->"1d3532fb-2387-4c2e-a20d-d0288b897da8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14077, 415, 228, 4, 32, "Item",ExpressionUUID->"565c7ed0-0d75-4ce6-b48b-7184deaaea83"],
Cell[14308, 421, 695, 15, 29, "Input",ExpressionUUID->"8ef72d0e-6f40-4da7-a1ea-89dabe994556"],
Cell[15006, 438, 939, 24, 29, "Input",ExpressionUUID->"60e7e60c-c8a4-490d-8955-520f493cc979"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[15994, 468, 166, 3, 68, "Section",ExpressionUUID->"12bb2de2-00ee-4ca0-af0a-85b2727de249"],
Cell[CellGroupData[{
Cell[16185, 475, 531, 17, 32, "Item",ExpressionUUID->"7c757291-a4a2-4019-9523-11abc7352db3"],
Cell[16719, 494, 1463, 39, 92, "Input",ExpressionUUID->"b591ca38-9f5c-460a-a257-e08904005b58"],
Cell[18185, 535, 1845, 50, 92, "Input",ExpressionUUID->"8242a4a1-b41e-456e-bf43-b893eb3fde11"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[20079, 591, 221, 3, 68, "Section",ExpressionUUID->"b87a1778-44e8-4718-b32f-c884c57cd7a5"],
Cell[CellGroupData[{
Cell[20325, 598, 243, 6, 32, "Item",ExpressionUUID->"2fe6806b-fd27-4737-801e-6518c4c9d7d0"],
Cell[CellGroupData[{
Cell[20593, 608, 202, 3, 26, "Subitem",ExpressionUUID->"a5281885-7faa-43a6-9f5c-9afff7f10d3f"],
Cell[20798, 613, 14260, 310, 1164, "Input",ExpressionUUID->"7a8c3372-0e28-4701-90d1-919ecca3e893"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[35107, 929, 232, 5, 32, "Item",ExpressionUUID->"0e914c5b-e89f-4932-885d-98f1fc4d86a5"],
Cell[35342, 936, 231, 3, 29, "Input",ExpressionUUID->"34cb7696-72d7-40d5-adb4-134df9af6e41"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[35622, 945, 168, 3, 68, "Section",ExpressionUUID->"12c2c3d9-dc8f-4a7f-b8ad-3379d8af03e5"],
Cell[35793, 950, 289, 6, 32, "Item",ExpressionUUID->"121c1215-e818-40b1-bbf7-e6c04a8217b7"],
Cell[CellGroupData[{
Cell[36107, 960, 292, 7, 32, "Item",ExpressionUUID->"1595b219-35fe-4495-b9c6-5c01d4d9d28a"],
Cell[36402, 969, 399, 8, 26, "Subitem",ExpressionUUID->"8d8ea756-d014-437d-b91e-7eb5740d1d07"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36838, 982, 559, 15, 32, "Item",ExpressionUUID->"3fb2f1f9-c0f2-4815-a25f-a578fe9fdb40"],
Cell[CellGroupData[{
Cell[37422, 1001, 200, 3, 26, "Subitem",ExpressionUUID->"900f7167-f439-4d10-a031-fc13bec10c6b"],
Cell[37625, 1006, 4260, 97, 268, "Input",ExpressionUUID->"19de2907-9c6e-443a-90e1-e4f98e6ad428"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[41946, 1110, 217, 4, 68, "Section",ExpressionUUID->"dc08f56e-8d6f-4e97-bdd4-2c27ecb891e2"],
Cell[CellGroupData[{
Cell[42188, 1118, 308, 7, 32, "Item",ExpressionUUID->"dbf3dcda-a7ea-42bc-8196-52c732ec380c"],
Cell[42499, 1127, 291, 6, 26, "Subitem",ExpressionUUID->"5eb9a1fe-867d-4af7-af71-9fe8ad0a18d9"]
}, Open  ]],
Cell[42805, 1136, 440, 9, 53, "Item",ExpressionUUID->"28bc21fa-2e72-480a-bee5-d3c67ff90996"],
Cell[CellGroupData[{
Cell[43270, 1149, 165, 3, 32, "Item",ExpressionUUID->"e846384c-0d29-4bf5-9418-2aa70da72fb7"],
Cell[CellGroupData[{
Cell[43460, 1156, 253, 6, 26, "Subitem",ExpressionUUID->"db243018-f8f7-4a77-9205-47bdb8f8b1d7"],
Cell[43716, 1164, 1669, 41, 160, "Input",ExpressionUUID->"f599cf75-6528-404f-ab93-b3a27b6ba2ce"],
Cell[45388, 1207, 1013, 22, 29, "Input",ExpressionUUID->"7e176713-c3cc-4c3a-ae44-42880167e7f3"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[46450, 1235, 315, 7, 32, "Item",ExpressionUUID->"2526f453-ed28-4c88-9951-b13e58c10fcb"],
Cell[46768, 1244, 234, 6, 26, "Subitem",ExpressionUUID->"7b7619e4-6e1c-4775-b628-4899cf81a809"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[47051, 1256, 172, 3, 68, "Section",ExpressionUUID->"2c8d1b75-ae02-49e5-a2fa-c53e51e9eb74"],
Cell[CellGroupData[{
Cell[47248, 1263, 250, 6, 32, "Item",ExpressionUUID->"59f87162-69d0-4c34-99ff-8aab7b7c8c80"],
Cell[CellGroupData[{
Cell[47523, 1273, 259, 6, 26, "Subitem",ExpressionUUID->"567fb4ab-e991-48a8-a9d2-9eaecab82ca7"],
Cell[47785, 1281, 3049, 73, 504, "Input",ExpressionUUID->"0bc3ee66-d90a-4baf-92ba-6b29ff393f2f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[50883, 1360, 474, 14, 32, "Item",ExpressionUUID->"d33a68f2-4588-4751-b72a-6a9deefa89a3"],
Cell[51360, 1376, 1728, 45, 92, "Input",ExpressionUUID->"bec39be6-39b6-41ff-ae65-1b6726c1e096"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53125, 1426, 181, 3, 32, "Item",ExpressionUUID->"90c25161-e66c-47ff-b5e0-4087f6ffc576"],
Cell[53309, 1431, 947, 25, 32, "Input",ExpressionUUID->"a77277d4-0863-4052-bc54-c9d1abab5ec1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54293, 1461, 525, 14, 32, "Item",ExpressionUUID->"53c62145-e0da-4a13-bd64-da17b67c6866"],
Cell[54821, 1477, 787, 18, 71, "Input",ExpressionUUID->"dd882544-5c6b-4bb7-b9cd-d83014716a68"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[55657, 1501, 169, 3, 68, "Section",ExpressionUUID->"00d26a81-25aa-4120-9f76-d790e36d0b7f"],
Cell[CellGroupData[{
Cell[55851, 1508, 228, 5, 32, "Item",ExpressionUUID->"e91bdce8-abf2-419d-aa3b-973224567f34"],
Cell[56082, 1515, 1767, 43, 113, "Input",ExpressionUUID->"669003af-a887-4164-9f45-da99d322e872"],
Cell[57852, 1560, 284, 5, 29, "Input",ExpressionUUID->"159a0139-36d1-4980-a7ff-406b006b36ae"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

